package dz.ade.pfe.service.exploitation.getreadingdetails;

import dz.ade.pfe.domain.ouvrage.CycleOuvrage;
import dz.ade.pfe.domain.ouvrage.ExploitationReading;
import dz.ade.pfe.domain.ouvrage.WorkStopTimes;
import dz.ade.pfe.port.in.exploitation.GetReadingQuery;
import dz.ade.pfe.port.out.exploitation.loadreading.LoadReadingDetails;
import dz.ade.pfe.service.exploitation.updatereading.EtatDto;
import dz.ade.pfe.service.exploitation.updatereading.EtatUpdateMapper;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.List;


@Service
@RequiredArgsConstructor
public class GetReadingService implements GetReadingQuery {
    private final LoadReadingDetails loadReadingDetails;
    private final ReadingDetailsMapper readingMapper ;
    private final EtatUpdateMapper etatUpdateMapper;

    @Override
    public ReadingDto getReadingDetails(String code, String id) {
        ExploitationReading reading = loadReadingDetails.loadReading(code,id);
        List<WorkStopTimes> times = loadReadingDetails.loadWorkStops(id);
         return readingMapper.ReadingDtoToExpReading(reading,times);
    }

    @Override
    public EtatDto getEtatDetails(String code, String id) {
       CycleOuvrage cycle =  loadReadingDetails.loadEtat(code, id);
        return etatUpdateMapper.CycleToDto(cycle);
    }
}
